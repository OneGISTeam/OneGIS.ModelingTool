/* -*-c++-*- OpenSceneGraph - Copyright (C) 1998-2006 Robert Osfield 
 *
 * This library is open source and may be redistributed and/or modified under  
 * the terms of the OpenSceneGraph Public License (OSGPL) version 0.0 or 
 * (at your option) any later version.  The full license is in LICENSE file
 * included with this distribution, and on the openscenegraph.org website.
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 * OpenSceneGraph Public License for more details.
*/

#ifndef VBF_SGDB_AUTHENTICATIONMAP
#define VBF_SGDB_AUTHENTICATIONMAP 1

#include <VBF_Base/VBF_Referenced.h>
#include <VBF_Base/ref_ptr>

#include <VBF_Engine/VBF_SGDB/Export>

#include <string>
#include <map>

namespace osgDB {


//class Archive;

// 口令
class AuthenticationDetails : public ::CVBF_Referenced
{
public:

    enum HttpAuthentication //Http信任(安全)技术，细节查看libcurl文档（names and associated functionality节）
    {
        BASIC           = 1<<0,
        DIGEST          = 1<<1,
        NTLM            = 1<<2,
        GSSNegotiate    = 1<<2,
        ANY             = ~0,
        ANYSAFE         = ~BASIC
    };

    AuthenticationDetails(const std::string& u, const std::string& p, HttpAuthentication auth=BASIC):
        username(u),
        password(p),
        httpAuthentication(auth) {}

    std::string         username;            // 用户名
    std::string         password;            // 口令
    HttpAuthentication  httpAuthentication;  // 信任协议（安全协议）

protected:
    virtual ~AuthenticationDetails() {}
};


// 口令表（信任表）
class VBF_SGDB_EXPORT AuthenticationMap : public ::CVBF_Referenced
{
public:   
    AuthenticationMap();

	virtual void addAuthenticationDetails(const std::string& path, AuthenticationDetails* details);
	virtual const AuthenticationDetails* getAuthenticationDetails(const std::string& path) const;

protected:   
    virtual ~AuthenticationMap();

	typedef std::map<std::string, ref_ptr<AuthenticationDetails> > AuthenticationDetailsMap;
	AuthenticationDetailsMap _authenticationMap;

};

}

#endif // VBF_SGDB_AUTHENTICATIONMAP
